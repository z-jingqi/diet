# 📄 智能饮食推荐与食材筛选系统

## 🧠 项目目标

本项目旨在为用户提供一个智能饮食推荐网页 App，功能包括：

- 支持多种饮食限制条件（如 IgA肾病、高血压、糖尿病等）
- 查询日常食材是否可食用，标记为【可吃】【不建议】【适量】
- 支持输入一道菜名，自动识别其食材组成，并判断是否适合用户
- 支持基于用户可食用食材范围和饮食限制，**AI 自动生成推荐菜谱**
- 支持未来上传/补充菜谱、饮食注意事项等知识

## 🔍 目标用户

- 需要特殊饮食管理的人群（如 IgA肾病、高血压、糖尿病等）
- 想要清楚知道"我能不能吃？""这道菜对我合适吗？"的用户
- 家属、营养师等辅助饮食管理者

## 📚 功能模块设计

### 1. ✅ 饮食限制条件配置

用户可以选择一个或多个饮食限制条件，系统会根据选择的条件提供相应的饮食建议。

### 2. ✅ 食材可用性查询模块

用户可以搜索任意一个食材，系统根据后台数据库返回是否【可吃】【不建议】【适量】。

### 3. ✅ 菜谱生成模块

支持根据用户选择的饮食限制条件生成菜谱。

### 4. ✅ 个人中心模块

#### 4.1 用户信息
- 用户昵称/头像
- 饮食限制条件标签

#### 4.2 界面设置
- 界面主题设置

#### 4.3 历史记录
- 最近查看的菜谱

#### 4.4 数据管理
- 数据导出/导入

### 5. ✅ 收藏管理模块

#### 5.1 分类管理
- 收藏分类管理
- 批量移动分类

#### 5.2 收藏操作
- 收藏列表展示
- 取消收藏
- 批量取消收藏
- 批量导出菜谱

#### 5.3 智能推荐
- 基于收藏的相似菜谱推荐
- 基于收藏的食材推荐
- 基于收藏的饮食建议

#### 5.4 数据分析
- 数据统计

## 🧩 技术架构

| 分类 | 技术/库 | 用途 |
|------|---------|------|
| 项目结构 | Turborepo | Monorepo 管理工具 |
| 前端框架 | Vite + React | 轻量级前端框架，开发体验好 |
| UI | shadcn/ui + Tailwind CSS | 高颜值组件库和样式系统 |
| 状态管理 | Context Reducer | 管理用户选择、搜索历史等状态 |
| 数据库 | Cloudflare D1 (SQLite) | Serverless SQLite 数据库 |
| ORM | Drizzle ORM | 类型安全的数据库操作 |
| 数据迁移 | Drizzle Kit | 数据库迁移和版本管理 |
| 搜索 | Fuse.js | 支持模糊搜索菜名和食材 |
| AI 接口 | OpenAI API | 菜谱生成和食材分析 |
| 表单 | react-hook-form + zod | 表单验证和类型安全 |
| 动画 | Framer Motion | 页面过渡和交互动画 |
| 路由 | React Router | 客户端路由管理 |
| 构建工具 | Vite | 快速的开发服务器和构建工具 |
| API 服务 | Hono | 高性能现代 Web 框架 |
| 部署 | Cloudflare Workers | Serverless 部署方案 |

## 📁 项目结构

```
.
├── packages/
│   ├── client/           # 前端应用
│   │   ├── src/
│   │   │   ├── pages/    # 页面组件
│   │   │   ├── components/ # 共享组件
│   │   │   │   ├── ui/   # 基础 UI 组件
│   │   │   │   ├── chat/ # 聊天相关组件
│   │   │   │   └── recipe/ # 菜谱相关组件
│   │   │   ├── types/   # TypeScript 类型定义
│   │   │   ├── store/   # 状态管理
│   │   │   ├── prompts/ # AI 提示词模板
│   │   │   └── lib/     # 工具函数
│   │   └── package.json # 前端依赖配置
│   │
│   ├── api/             # 后端 API 服务
│   │   ├── src/
│   │   │   ├── routes/  # API 路由
│   │   │   ├── services/ # 业务逻辑
│   │   │   ├── db/      # 数据库相关
│   │   │   │   ├── schema.ts # 数据库表结构定义
│   │   │   │   └── seed-data.sql # 种子数据
│   │   │   ├── migrations/ # 数据库迁移文件
│   │   │   └── utils/   # 工具函数
│   │   ├── DATABASE_MANAGEMENT.md # 📖 [数据库管理指南](./packages/api/DATABASE_MANAGEMENT.md)
│   │   └── package.json # API 依赖配置
│   │
│   └── shared/          # 共享类型和工具
│       ├── src/
│       │   ├── types/   # 共享类型定义
│       │   ├── schemas/ # 数据验证模式
│       │   └── prompts/ # 共享提示词
│       └── package.json # 共享依赖配置
│
├── package.json         # 工作空间配置
├── turbo.json          # Turborepo 配置
└── README.md           # 项目文档
```

## 🔄 当前进度

### ✅ 已完成
1. 项目基础架构搭建
2. 用户认证系统
3. 聊天对话功能
4. 标签系统（饮食限制条件）
5. 数据库设计和迁移
6. AI 菜谱生成
7. 健康建议功能

### 📝 待开发
1. 用户历史记录
2. 本地存储管理
3. 搜索功能
4. 数据验证系统
5. 收藏管理模块

## 🔮 未来计划

- 用户历史记录与本地存储
- 周推荐计划、营养图表
- 多疾病组合支持
- 离线支持 (PWA)
- 数据导入导出功能
- 社区分享功能
- 营养师在线咨询

## 📌 开发注意事项

- AI 生成内容需二次校验，确保安全性
- 支持用户自定义饮食限制条件
- 知识库可拓展，多疾病配置支持
- 确保 JSON 数据格式统一，便于维护
- 使用 Vite 的静态资源处理功能优化加载性能
- 实现 PWA 支持离线访问
- 使用 Turborepo 管理多包依赖和构建
- 遵循 monorepo 最佳实践，保持包之间的独立性
- 使用 Cloudflare Workers 实现 Serverless 部署
- 确保前后端 API 接口类型安全
- 使用 Drizzle ORM 进行类型安全的数据库操作
- 遵循数据库迁移最佳实践，确保数据一致性

## 📖 相关文档

- [📖 数据库管理指南](./packages/api/DATABASE_MANAGEMENT.md) - 详细的数据库操作指南
- [🔐 认证系统文档](./packages/api/AUTH_README.md) - 用户认证和会话管理
- [🔄 刷新令牌文档](./packages/api/REFRESH_TOKEN_README.md) - 令牌刷新机制
